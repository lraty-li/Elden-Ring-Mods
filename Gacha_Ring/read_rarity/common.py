yabberPath=r"D:/Game/ERModing/Yabber.1.3.1/Yabber.exe"

langs=["deude","frafr","itait","jpnjp","korkr","polpl","porbr","rusru","spaar","spaes","thath","engus","zhocn","zhotw"]

msgNameFile = ['AccessoryName', 'GoodsName', 'ProtectorName', 'WeaponName', 'GemName']

csvParam = ['EquipParamAccessory', 'EquipParamGoods', 'EquipParamProtector', 'EquipParamWeapon', 'EquipParamGem']
itemTypeMap = {
    'EquipParamGoods': 1,
    'EquipParamWeapon': 2,
    'EquipParamProtector': 3,
    'EquipParamAccessory': 4,
    'EquipParamGem': 5
}
itemTypeMapReversed = { str(itemTypeMap[k]) : k for k in itemTypeMap.keys()}


template = "{};Gacha_Ring {};{};0;0;0;0;0;0;0;{};0;0;0;0;0;0;0;1000;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;1062265999;0;0;-1;1;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;-1;0;0;0;0;"

tempFillerGoods = {
      "10000": "玻璃碎片",
      "15000": "肉片",
      "15010": "野兽肝",
      "15020": "野兽肉块",
      "15030": "野兽血液",
      "15060": "拨风羽毛",
      "15080": "四趾鸟爪",
      "15090": "龟颈肉块",
      "15100": "人骨碎片",
      "15110": "大蜻蜓头部",
      "15120": "眠卵",
      "15130": "蟹卵",
      "15140": "章鱼卵",
      "15150": "米兰达花粉",
      "15160": "白色肉片",
      "15340": "细小兽骨",
      "15341": "粗大兽骨",
      "15400": "绳索",
      "20650": "毒花",
      "20652": "雷电花",
      "20654": "墓地紫花",
      "20660": "变色落叶花",
      "20680": "落叶花",
      "20681": "亚塔斯花",
      "20682": "火焰花",
      "20683": "金轮草",
      "20685": "褪色金轮草",
      "20690": "赫帕草",
      "20710": "夜露赫帕草",
      "20720": "罗亚果实",
      "20721": "黄金罗亚果实",
      "20722": "罗亚原种果实",
      "20750": "结晶木芽",
      "20751": "冰结晶木芽",
      "20760": "蘑菇",
      "20761": "稠液蘑菇",
      "20770": "毒霉蘑菇",
      "20775": "根脂",
      "20780": "崩解结晶",
      "20802": "火星蝶",
      "20812": "辉石萤火虫",
      "20830": "金色排泄物",
      "20831": "和血排泄物",
      "20840": "洞窟苔藓",
      "20841": "洞窟苔藓的花苞",
      "20842": "洞窟苔藓的结晶",
      "20850": "火山石",
      "300": "火焰壶",
      "301": "红狮子火焰壶",
      "302": "巨人火火焰壶",
      "320": "雷电壶",
      "330": "粪便壶",
      "340": "苍蝇壶",
      "350": "圣水壶",
      "360": "结冰壶",
      "370": "毒壶",
      "380": "油壶",
      "400": "附绳火焰壶",
      "420": "附绳雷电壶",
      "430": "附绳粪便壶",
      "440": "附绳毒壶",
      "450": "附绳油壶",
      "460": "附绳魔力壶",
      "470": "附绳苍蝇壶",
      "480": "[ERROR]附绳结冰壶",
      "490": "附绳火山壶",
      "510": "附绳圣水壶",
      "600": "火山壶",
      "650": "怨魂壶",
      "660": "魔力壶",
      "661": "学院魔力壶",
      "810": "罗亚果干",
      "811": "甜酿果干",
      "812": "冰冻果干",
      "820": "煮熟螃蟹",
      "830": "煮熟虾子",
      "900": "中毒苔药",
      "910": "出血苔药",
      "920": "冻伤苔药",
      "930": "催眠苔药",
      "1100": "腌制龟颈肉",
      "1110": "免疫肉干",
      "1120": "健壮肉干",
      "1150": "抗魔肝脏干",
      "1160": "抗火肝脏干",
      "1170": "抗雷肝脏干",
      "1180": "抗圣肝脏干",
      "1235": "生肉丸",
      "1310": "免疫白肉干",
      "1320": "健壮白肉干",
      "1400": "火油脂",
      "1410": "雷油脂",
      "1420": "魔力油脂",
      "1430": "圣油脂",
      "1440": "出血油脂",
      "1460": "中毒油脂",
      "1470": "结冰油脂",
      "1500": "附绳火油脂",
      "1510": "附绳雷油脂",
      "1520": "附绳魔力油脂",
      "1530": "附绳圣油脂",
      "1540": "附绳出血油脂",
      "1560": "附绳中毒油脂",
      "1570": "[ERROR]附绳结冰油脂",
      "1690": "坚盾油脂",
      "1700": "投掷匕首",
      "1710": "兽骨飞刀",
      "1720": "兽骨毒飞刀",
      "1730": "廓尔喀弯刀",
      "1740": "结晶飞刀",
      "1750": "扇形暗器",
      "1760": "遗迹石",
      "1830": "爆炸石",
      "1831": "爆炸石块",
      "1840": "毒石",
      "1841": "毒石块",
      "2020": "虹彩石",
      "2030": "照明石",
      "2050": "拟态赐福",
      "2100": "柔软棉花",
      "2120": "肥皂",
      "2900": "黄金卢恩【１】",
      "2901": "黄金卢恩【２】",
      "2902": "黄金卢恩【３】",
      "2903": "黄金卢恩【４】",
      "2904": "黄金卢恩【５】",
      "3030": "杜鹃辉石",
      "3050": "崩裂辉石",
      "3051": "大块崩裂辉石",
      "3060": "扇形重力石",
      "3070": "块状重力石",
      "3300": "[ERROR]圣水油脂",
      "3320": "絮语石",
      "3510": "火花香",
      "3580": "毒发喷雾",

      "2905": "黄金卢恩【６】",
      "2906": "黄金卢恩【７】",
      "2907": "黄金卢恩【８】",
      "2908": "黄金卢恩【９】",
      "2909": "黄金卢恩【１０】",
      "2910": "黄金卢恩【１１】",
      "2911": "黄金卢恩【１２】",
      "2912": "黄金卢恩【１３】",
      "2990": "交界地卢恩",
      "3310": "温热石",
      "3311": "癫火石",
      "3350": "魅惑树枝",
      "3360": "床帘恩泽",
      "3500": "振奋香",
      "3520": "铁壶香药",
      "3550": "狂热香药",

      "321": "古龙雷电壶",
      "351": "圣律壶",
      "390": "诱敌壶",
      "391": "引兽壶",
      "610": "白金壶",
      "630": "咒血壶",
      "640": "催眠壶",
      "670": "腐败壶",
      "940": "腐败苔药",
      "950": "死亡苔药",
      "960": "发狂苔药",
      "1130": "理智肉干",
      "1140": "斑斓肉干",
      "1190": "腌制白银鸟爪",
      "1200": "腌制黄金鸟爪",
      "1210": "勇者肉块",
      "1220": "[ERROR]抗死肉干",
      "1330": "理智白肉干",
      "1340": "斑斓白肉干",
      "1350": "[ERROR]抗死白肉干",
      "1450": "催眠油脂",
      "1480": "伤龙油脂",
      "1490": "腐败油脂",
      "1550": "附绳催眠油脂",
      "1590": "附绳腐败油脂",

      "190": "卢恩弯弧",
      "1290": "星光碎片",

      "20651": "托莉娜睡莲",
      "20653": "米凯拉睡莲",
      "20691": "亚缇莉亚叶",
      "20740": "耶罗眼珠",
      "20753": "圣血木芽",
      "20800": "蜕生蝶",
      "20801": "艾奥尼亚蝶",
      "20820": "黄金百足",
      "20855": "碎石",
      "8185": "泪滴幼体",

      "10070": "失力战灰",
      "10100": "锻造石【１】",
      "10101": "锻造石【２】",
      "10102": "锻造石【３】",
      "10103": "锻造石【４】",
      "10104": "锻造石【５】",
      "10105": "锻造石【６】",
      "10106": "锻造石【７】",
      "10107": "锻造石【８】",
      "10160": "失色锻造石【１】",
      "10161": "失色锻造石【２】",
      "10162": "失色锻造石【３】",
      "10163": "失色锻造石【４】",
      "10164": "失色锻造石【５】",
      "10165": "失色锻造石【６】",
      "10166": "失色锻造石【７】",
      "10167": "失色锻造石【８】",
      "10200": "失色锻造石【９】",
      "10900": "墓地铃兰【１】",
      "10901": "墓地铃兰【２】",
      "10902": "墓地铃兰【３】",
      "10903": "墓地铃兰【４】",
      "10904": "墓地铃兰【５】",
      "10905": "墓地铃兰【６】",
      "10906": "墓地铃兰【７】",
      "10907": "墓地铃兰【８】",
      "10908": "墓地铃兰【９】",
      "10910": "灵依墓地铃兰【１】",
      "10911": "灵依墓地铃兰【２】",
      "10912": "灵依墓地铃兰【３】",
      "10913": "灵依墓地铃兰【４】",
      "10914": "灵依墓地铃兰【５】",
      "10915": "灵依墓地铃兰【６】",
      "10916": "灵依墓地铃兰【７】",
      "10917": "灵依墓地铃兰【８】",
      "10918": "灵依墓地铃兰【９】",
      "15040": "古牙",
      "15050": "芽角",
      "15410": "活壶碎片",
      "15420": "白金凝血",
      "15430": "风暴鹰羽毛",
      "20723": "血蔷薇",
      "20795": "神殿石",
      "20810": "银色萤火虫",
      "20811": "金色萤火虫",
      "20825": "银色泪滴空壳",
      "20845": "黄色余火",
      "20852": "蚁酸石",
  }
tempFillerWeapons = {
      "50000000": "箭矢",
      "50010000": "火箭",
      "50030000": "兽骨箭（附箭羽）",
      "50060000": "碎片生音箭（附箭羽）",
      "50080000": "虹彩石箭（附箭羽）",
      "50100000": "宿灵箭",
      "50110000": "兽骨箭",
      "50130000": "兽骨火箭（附箭羽）",
      "50140000": "兽骨火箭",
      "50150000": "兽骨毒箭（附箭羽）",
      "50160000": "兽骨毒箭",
      "50190000": "风暴羽毛兽骨箭",
      "50200000": "兽骨雷箭（附箭羽）",
      "50210000": "兽骨雷箭",
      "50220000": "虹彩石箭",
      "50230000": "碎片生音箭",
      "50260000": "兽骨魔力箭（附箭羽）",
      "50270000": "兽骨魔力箭",
      "50280000": "兽骨圣箭（附箭羽）",
      "50290000": "兽骨圣箭",
      "50300000": "兽骨出血箭（附箭羽）",
      "50310000": "兽骨出血箭",
      "50320000": "兽骨结冰箭（附箭羽）",
      "50330000": "兽骨结冰箭",
      "51000000": "大箭",
      "51010000": "魔像大箭",
      "51050000": "兽骨大箭（附箭羽）",
      "51060000": "兽骨大箭",
      "52000000": "弩箭",
      "52070000": "黄金弩箭",
      "52080000": "君王军弩箭",
      "52090000": "兽骨弩箭",
      "52100000": "兽骨火弩箭",
      "52110000": "兽骨雷弩箭",
      "52120000": "兽骨魔力弩箭",
      "52130000": "兽骨圣弩箭",
      "52140000": "兽骨毒弩箭",
      "52150000": "兽骨出血弩箭",
      "52160000": "兽骨结冰弩箭",
      "52190000": "猛火弩箭",
      "53000000": "弩炮箭",
      "53030000": "兽骨弩炮箭",
      "50020000": "飞蛇毒箭",
      "50040000": "托莉娜箭",
      "50090000": "黄金箭",
      "50170000": "兽骨催眠箭（附箭羽）",
      "50180000": "兽骨催眠箭",
      "50240000": "灵火箭",
      "50340000": "兽骨腐败箭（附箭羽）",
      "50350000": "兽骨腐败箭",
      "51020000": "黄金大箭",
      "51030000": "魔像魔力箭",
      "51040000": "拉塔恩的矛",
      "52010000": "雷电弩箭",
      "52020000": "调香弩箭",
      "52030000": "黑键木桩",
      "52040000": "倒刺弩箭",
      "52050000": "流星弩箭",
      "52060000": "爆炸弩箭",
      "52170000": "兽骨腐败弩箭",
      "52180000": "兽骨催眠弩箭",
      "53010000": "雷电大弩箭",
      "53020000": "爆炸大弩箭"
  }

def genCsvData(iterable, countdownLimit=-1):
  global lotIdCounter
  try:
    csvLines = []
    for catagory in iterable:
      for i in iterable[catagory]:
        # is goods
        # if(len(iterable[catagory][i]) > 1 and iterable[catagory][i][1] in goodsTypeKeys):
        #   csvLines.append(template.format(lotIdCounter, iterable[catagory][i][0], i, itemTypeMap[goodsType[iterable[catagory][i][1]]]))
        # else:
        csvLines.append(template.format(lotIdCounter, iterable[catagory][i][0], i, itemTypeMap[catagory]))
        lotIdCounter += 10
        countdownLimit -= 1
        if(countdownLimit == 0):
          raise Exception()
    return csvLines
  except Exception as e:
    return csvLines


def appendCsvLine(allCsvLines, iterable):
  for catagory in iterable:
    for line in iterable[catagory]:
      allCsvLines.append(line)

def readNames(folderPath):

  allNames = {}
  for index in range(len(csvParam)):
    allNames[csvParam[index]] = loadNamesXml(os.path.join(folderPath, msgNameFile[index] + '.fmg.xml'))
  return allNames

